var sceneIO = {
	metadata: {
		generator: "Object3D.toJSON",
		type: "Object",
		version: 4.4
	},
	geometries: [
		{"uuid":"geometry_floor","type":"PlaneGeometry","width":4,"height":4},
		// {"uuid":"geometry_wall","type":"BoxGeometry","width":4,"height":16,"depth":4},
		// {"uuid":"geometry_typeA","type":"BoxGeometry","width":3.6,"height":1.5,"depth":3.6},
		// {"uuid":"geometry_battery","type":"BoxGeometry","width":3.6,"height":1,"depth":3.6},
		{"uuid":"geometry_default","type":"PlaneGeometry","width":0.01,"height":0.01},	
		// {"uuid":"geometry_cabinet","type":"BufferGeometry","data":{"attributes":{"position":{"itemSize":3,"type":"Float32Array","array":[3,-6,2,3,6,2,-3,-6,2,3,6,2,-3,6,2,-3,-6,2,-3,-6,2,-3,6,2,-3,-6,-2,-3,6,2,-3,6,-2,-3,-6,-2,-3,-6,-2,-3,6,-2,3,-6,-2,-3,6,-2,3,6,-2,3,-6,-2,3,-5.599999904632568,1.600000023841858,3,-5.599999904632568,-1.600000023841858,-2.5999999046325684,-5.599999904632568,1.600000023841858,3,-5.599999904632568,-1.600000023841858,-2.5999999046325684,-5.599999904632568,-1.600000023841858,-2.5999999046325684,-5.599999904632568,1.600000023841858,-3,-6,2,-3,-6,-2,3,-6,2,-3,-6,-2,3,-6,-2,3,-6,2,-3,6,-2,-3,6,2,3,6,-2,-3,6,2,3,6,2,3,6,-2,3,-5.599999904632568,1.600000023841858,3,5.599999904632568,1.600000023841858,3,-6,2,3,5.599999904632568,1.600000023841858,3,6,2,3,-6,2,3,5.599999904632568,-1.600000023841858,3,-5.599999904632568,-1.600000023841858,3,6,-2,3,-5.599999904632568,-1.600000023841858,3,-6,-2,3,6,-2,3,-5.599999904632568,-1.600000023841858,3,-5.599999904632568,1.600000023841858,3,-6,-2,3,-5.599999904632568,1.600000023841858,3,-6,2,3,-6,-2,3,5.599999904632568,1.600000023841858,3,5.599999904632568,-1.600000023841858,3,6,2,3,5.599999904632568,-1.600000023841858,3,6,-2,3,6,2,-2.5999999046325684,-5.599999904632568,-1.600000023841858,-2.5999999046325684,5.599999904632568,-1.600000023841858,-2.5999999046325684,-5.599999904632568,1.600000023841858,-2.5999999046325684,5.599999904632568,-1.600000023841858,-2.5999999046325684,5.599999904632568,1.600000023841858,-2.5999999046325684,-5.599999904632568,1.600000023841858,3,5.599999904632568,1.600000023841858,3,-5.599999904632568,1.600000023841858,-2.5999999046325684,5.599999904632568,1.600000023841858,3,-5.599999904632568,1.600000023841858,-2.5999999046325684,-5.599999904632568,1.600000023841858,-2.5999999046325684,5.599999904632568,1.600000023841858,3,5.599999904632568,-1.600000023841858,3,5.599999904632568,1.600000023841858,-2.5999999046325684,5.599999904632568,-1.600000023841858,3,5.599999904632568,1.600000023841858,-2.5999999046325684,5.599999904632568,1.600000023841858,-2.5999999046325684,5.599999904632568,-1.600000023841858,3,-5.599999904632568,-1.600000023841858,3,5.599999904632568,-1.600000023841858,-2.5999999046325684,-5.599999904632568,-1.600000023841858,3,5.599999904632568,-1.600000023841858,-2.5999999046325684,5.599999904632568,-1.600000023841858,-2.5999999046325684,-5.599999904632568,-1.600000023841858],"normalized":false},"normal":{"itemSize":3,"type":"Float32Array","array":[0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,-0.5,0,0,-0.5,0,0,-0.5,0,0,-0.5,0,0,-0.5,0,0,-0.5,0,0,0,0,-0.5,0,0,-0.5,0,0,-0.5,0,0,-0.5,0,0,-0.5,0,0,-0.5,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,-0.5,0,0,-0.5,0,0,-0.5,0,0,-0.5,0,0,-0.5,0,0,-0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0,0,-0.5,0,0,-0.5,0,0,-0.5,0,0,-0.5,0,0,-0.5,0,0,-0.5,0,-0.5,0,0,-0.5,0,0,-0.5,0,0,-0.5,0,0,-0.5,0,0,-0.5,0,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5,0,0,0.5],"normalized":false},"uv":{"itemSize":2,"type":"Float32Array","array":[0.0003000000142492354,0.5551000237464905,0.0003000000142492354,0.27799999713897705,0.2773999869823456,0.5551000237464905,0.0003000000142492354,0.27799999713897705,0.2773999869823456,0.27799999713897705,0.2773999869823456,0.5551000237464905,0.27799999713897705,0.5551000237464905,0.27799999713897705,0.27799999713897705,0.5551000237464905,0.5551000237464905,0.27799999713897705,0.27799999713897705,0.5551000237464905,0.27799999713897705,0.5551000237464905,0.5551000237464905,0.8328999876976013,0.0003000000142492354,0.8328999876976013,0.2773999869823456,0.5557000041007996,0.0003000000142492354,0.8328999876976013,0.2773999869823456,0.5557000041007996,0.2773999869823456,0.5557000041007996,0.0003000000142492354,0.5188000202178955,0.777400016784668,0.5188000202178955,0.5557000041007996,0.777400016784668,0.777400016784668,0.5188000202178955,0.5557000041007996,0.777400016784668,0.5557000041007996,0.777400016784668,0.777400016784668,0.2773999869823456,0.2773999869823456,0.0003000000142492354,0.2773999869823456,0.2773999869823456,0.0003000000142492354,0.0003000000142492354,0.2773999869823456,0.0003000000142492354,0.0003000000142492354,0.2773999869823456,0.0003000000142492354,0.5551000237464905,0.2773999869823456,0.27799999713897705,0.2773999869823456,0.5551000237464905,0.0003000000142492354,0.27799999713897705,0.2773999869823456,0.27799999713897705,0.0003000000142492354,0.5551000237464905,0.0003000000142492354,0.8611000180244446,0.009499999694526196,0.8611000180244446,0.26820001006126404,0.8334000110626221,0.0003000000142492354,0.8611000180244446,0.26820001006126404,0.8334000110626221,0.2773999869823456,0.8334000110626221,0.0003000000142492354,0.8616999983787537,0.26820001006126404,0.8616999983787537,0.009499999694526196,0.8894000053405762,0.2773999869823456,0.8616999983787537,0.009499999694526196,0.8894000053405762,0.0003000000142492354,0.8894000053405762,0.2773999869823456,0.527400016784668,0.8241999745368958,0.30570000410079956,0.8241999745368958,0.5551000237464905,0.8149999976158142,0.30570000410079956,0.8241999745368958,0.27799999713897705,0.8149999976158142,0.5551000237464905,0.8149999976158142,0.02800000086426735,0.8149999976158142,0.24969999492168427,0.8149999976158142,0.0003000000142492354,0.8241999745368958,0.24969999492168427,0.8149999976158142,0.2773999869823456,0.8241999745368958,0.0003000000142492354,0.8241999745368958,0.9997000098228455,0.5557000041007996,0.9997000098228455,0.8144000172615051,0.777999997138977,0.5557000041007996,0.9997000098228455,0.8144000172615051,0.777999997138977,0.8144000172615051,0.777999997138977,0.5557000041007996,0.0003000000142492354,0.8144000172615051,0.0003000000142492354,0.5557000041007996,0.258899986743927,0.8144000172615051,0.0003000000142492354,0.5557000041007996,0.258899986743927,0.5557000041007996,0.258899986743927,0.8144000172615051,0.5557000041007996,0.49970000982284546,0.5557000041007996,0.27799999713897705,0.8144000172615051,0.49970000982284546,0.5557000041007996,0.27799999713897705,0.8144000172615051,0.27799999713897705,0.8144000172615051,0.49970000982284546,0.25949999690055847,0.8144000172615051,0.25949999690055847,0.5557000041007996,0.5181999802589417,0.8144000172615051,0.25949999690055847,0.5557000041007996,0.5181999802589417,0.5557000041007996,0.5181999802589417,0.8144000172615051],"normalized":false}}}},	
	],
	materials: [
	    {"uuid":"material_floor","type":"MeshLambertMaterial","color":16777215,"emissive":0},
		// {"uuid":"material_typeA","type":"MeshLambertMaterial","color":4555558,"emissive":0},
		// {"uuid":"material_battery","type":"MeshLambertMaterial","color":1193046,"emissive":0},
	 //    {"uuid":"material_cabinet","type":"MeshLambertMaterial","color":16777215,"emissive":0,"map":"texture_cabinet"},
	    {"uuid":"material_nameTag","type":"SpriteMaterial","color":16777215,"map":""},
	    {"uuid":"material_default","type":"MeshBasicMaterial","color":16777215,"map":""},
	 //    {"uuid":"material_wall","type":"MeshLambertMaterial","color":9991764},
 	],
 	textures: [
	    // {"uuid":"texture_cabinet","name":"","mapping":300,"repeat":[1,1],"offset":[0,0],"wrap":[1001,1001],"minFilter":1008,"magFilter":1006,"anisotropy":1,"flipY":true,"image":"image_cabinet"},
	],
	images: [
	    // {"uuid":"image_cabinet","url":"img/cabinet/cabinet.jpg"},
	],

 	save: function(scene){
 		var resource = scene.toJSON();	//场景信息
 		//console.log(resource);

 		delete resource.metadata;
		delete resource.geometries;
		delete resource.materials;
		delete resource.textures;
		delete resource.images;

		//console.log(JSON.stringify(resource));		//传给后台的数据（场景信息）
		localStorage.setItem('scene', JSON.stringify(resource));
 	},
 	import: function(sceneData){
 		sceneData.metadata = this.metadata;
		sceneData.geometries = this.geometries;
		sceneData.materials = this.materials;
		sceneData.textures = this.textures;
		sceneData.images = this.images;

		return sceneData;
 	},
 	conversion: function(obj){
 		if(obj.name){
 			obj.geometry = "geometry_"+obj.name.type;
			obj.material = "material_"+obj.name.type;
 		}else{
 			obj.geometry = "geometry_default";
			obj.material = "material_default";
 		}
		if(obj.children && obj.children.length !== 0){
			for(var i=0;i<obj.children.length;i++){
				this.conversion(obj.children[i]);
			}
		}
	},
	createNameTagCanvas: function (name) {
	    var canvas = document.createElement('canvas');
	    canvas.width = 256;
	    canvas.height = 32;
	    var context = canvas.getContext('2d');
	    context.font = "Bold 28px Arial";
	    context.textAlign = 'center';
	    context.fillStyle = "rgba(255,255,255,0.95)";
	    context.fillText(name, 128, 28);
	    return canvas;
	},
}